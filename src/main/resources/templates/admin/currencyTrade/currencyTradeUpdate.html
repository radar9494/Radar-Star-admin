<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head th:include="admin/head :: head" th:with="title=交易对管理添加">
<body>
<div class="layuimini-container">
    <div class="layuimini-main">
        <form class="layui-form" action="" lay-filter="formfilter">
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>交易区域:</label>
                <div class="layui-input-inline">
                    <select lay-verify="required|areaId" id="areaId" name="areaId" disabled="disabled">
                        <option th:each="t,tState:${ areaList}" th:value="${t.id}" th:text="${t.name}" th:selected="${t.id==m.areaId}"></option>
                    </select>
                </div>
                <label class="layui-form-label"><span style="color: red">*</span>显示位置:</label>
                <div class="layui-input-inline">
                    <input type="text" id="position" name="position"  lay-verify="required|position" autocomplete="off" placeholder="显示位置" class="layui-input" th:value="${m.position}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>交易币种:</label>
                <div class="layui-input-inline">
                    <select lay-verify="required|tradeCurrencyId" id="tradeCurrencyId" name="tradeCurrencyId" disabled="disabled">
                        <option th:each="t,tState:${ currencyList}" th:value="${t.id}" th:text="${t.name}" th:selected="${t.id==m.tradeCurrencyId}"></option>
                    </select>
                </div>
                <label class="layui-form-label"><span style="color: red">*</span>币种名称:</label>
                <div class="layui-input-inline">
                    <select lay-verify="required|currencyId" id="currencyId" name="currencyId" disabled="disabled">
                        <option th:each="t,tState:${ currencyList}" th:value="${t.id}" th:text="${t.name}" th:selected="${t.id==m.currencyId}"></option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>状态:</label>
                <div class="layui-input-inline">
                    <input type="checkbox" th:checked="${m.status==1}" lay-filter="statusShow" lay-skin="switch" lay-text="开|关">
                    <input type="hidden" id="status" name="status" th:value="${m.status}">
                </div>
                <label class="layui-form-label"><span style="color: red">*</span>位置:</label>
                <div class="layui-input-inline">
                    <input type="radio" th:checked="${m.area==1}" name="area" value="1" title="主创区">
                    <input type="radio" th:checked="${m.area==2}" name="area" value="2" title="创新区">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">接口查询名称:</label>
                <div class="layui-input-block">
                    <input type="text" id="searchName" name="searchName"  autocomplete="off" placeholder="接口查询名称" class="layui-input"  th:value="${m.searchName}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>交易:</label>
                <div class="layui-input-inline">
                    <input type="checkbox"  th:checked="${m.tradeSwitch==1}" lay-filter="tradeSwitchShow" lay-skin="switch" lay-text="开|关">
                    <input type="hidden" id="tradeSwitch" name="tradeSwitch"  th:value="${m.tradeSwitch}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">买手续费%:</label>
                <div class="layui-input-inline">
                    <input type="text" id="buyRate" name="buyRate"  autocomplete="off" placeholder="买手续费" class="layui-input"  th:value="${m.buyRate}">
                </div>
                <label class="layui-form-label">卖手续费%:</label>
                <div class="layui-input-inline">
                    <input type="text" id="sellRate" name="sellRate"   autocomplete="off" placeholder="卖手续费" class="layui-input"  th:value="${m.sellRate}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>价格控制:</label>
                <div class="layui-input-inline">
                    <input type="checkbox"  th:checked="${m.priceSwitch==1}" lay-filter="priceSwitchShow" lay-skin="switch" lay-text="开|关">
                    <input type="hidden" id="priceSwitch" name="priceSwitch"  th:value="${m.priceSwitch}">
                </div>
            </div>
            <div class="layui-form-item" id="priceShow" style="display: none">
                <label class="layui-form-label">最小交易价格:</label>
                <div class="layui-input-inline">
                    <input type="text" id="minPirce" name="minPirce" autocomplete="off" placeholder="最小交易价格" class="layui-input"  th:value="${m.minPirce}">
                </div>
                <label class="layui-form-label">最大交易价格:</label>
                <div class="layui-input-inline">
                    <input type="text" id="maxPirce" name="maxPirce"  autocomplete="off" placeholder="最大交易价格" class="layui-input"  th:value="${m.maxPirce}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>数量控制:</label>
                <div class="layui-input-inline">
                    <input type="checkbox" th:checked="${m.quantitySwitch==1}" lay-filter="quantitySwitchShow" lay-skin="switch" lay-text="开|关">
                    <input type="hidden" id="quantitySwitch" name="quantitySwitch"  th:value="${m.quantitySwitch}">
                </div>
            </div>
            <div class="layui-form-item" id="quantityShow" style="display: none">
                <label class="layui-form-label">最小交易数量:</label>
                <div class="layui-input-inline">
                    <input type="text" id="minQuantity" name="minQuantity" autocomplete="off" placeholder="最小交易数量" class="layui-input"  th:value="${m.minQuantity}">
                </div>
                <label class="layui-form-label">最大交易数量:</label>
                <div class="layui-input-inline">
                    <input type="text" id="maxQuantity" name="maxQuantity" autocomplete="off" placeholder="最大交易数量" class="layui-input"  th:value="${m.maxQuantity}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>涨跌幅:</label>
                <div class="layui-input-inline">
                    <input type="checkbox" th:checked="${m.limitSwitch==1}"  lay-filter="limitSwitchShow" lay-skin="switch" lay-text="开|关">
                    <input type="hidden" id="limitSwitch" name="limitSwitch"  th:value="${m.limitSwitch}">
                </div>
                <label class="layui-form-label">涨跌幅百分比%:</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" id="limitRate" name="limitRate"  th:value="${m.limitRate}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>交易输小数位:</label>
                <div class="layui-input-inline">
                    <input type="text" id="digitsP" name="digitsP"  lay-verify="required|digitsP" autocomplete="off" placeholder="交易输入位数" class="layui-input"  th:value="${m.digitsP}">
                </div>
                <label class="layui-form-label"><span style="color: red">*</span>数量小数位:</label>
                <div class="layui-input-inline">
                    <input type="text" id="digitsQ" name="digitsQ"  lay-verify="required|digitsQ" autocomplete="off" placeholder="数量小数位" class="layui-input"  th:value="${m.digitsQ}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label"><span style="color: red">*</span>虚拟买卖盘:</label>
                <div class="layui-input-inline">
                    <input type="checkbox" th:checked="${m.virtualSwitch==1}" lay-filter="virtualSwitchShow" lay-skin="switch" lay-text="开|关">
                    <input type="hidden" id="virtualSwitch" name="virtualSwitch"  th:value="${m.virtualSwitch}">
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <input type="hidden" name="id" th:value="${m.id}">
                    <button class="layui-btn" lay-submit="" lay-filter="formSubmit">立即提交</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>


    layui.use(['layedit', 'layer', 'jquery','liuQi'], function () {
        var form = layui.form,
            liuQi = layui.liuQi,
            laydate = layui.laydate;

        form.on('switch(statusShow)', function(data){
            $("#status").val(this.checked?1:0);
        });
        form.on('switch(tradeSwitchShow)', function(data){
            $("#tradeSwitch").val(this.checked?1:0);
            if(this.checked){
                $("#tradeShow").show();
            }else{
                $("#tradeShow").hide();
            }
        });
        form.on('switch(priceSwitchShow)', function(data){
            $("#priceSwitch").val(this.checked?1:0);
            if(this.checked){
                $("#priceShow").show();
            }else{
                $("#priceShow").hide();
            }
        });
        form.on('switch(quantitySwitchShow)', function(data){
            $("#quantitySwitch").val(this.checked?1:0);
            if(this.checked){
                $("#quantityShow").show();
            }else{
                $("#quantityShow").hide();
            }
        });
        form.on('switch(limitSwitchShow)', function(data){
            $("#limitSwitch").val(this.checked?1:0);
        });
        form.on('switch(virtualSwitchShow)', function(data){
            $("#virtualSwitch").val(this.checked?1:0);
        });
        form.render();

        //自定义验证规则
        form.verify({
            //radio验证
            otherReq: function(value,item){
                var $ = layui.$;
                var verifyName=$(item).attr('name')
                    , verifyType=$(item).attr('type')
                    ,formElem=$(item).parents('.layui-form')//获取当前所在的form元素，如果存在的话
                    ,verifyElem=formElem.find('input[name='+verifyName+']')//获取需要校验的元素
                    ,isTrue= verifyElem.is(':checked')//是否命中校验
                    ,focusElem = verifyElem.next().find('i.layui-icon');//焦点元素
                if(!isTrue || !value){
                    //定位焦点
                    focusElem.css(verifyType=='radio'?{"color":"#FF5722"}:{"border-color":"#FF5722"});
                    //对非输入框设置焦点
                    focusElem.first().attr("tabIndex","1").css("outline","0").blur(function() {
                        focusElem.css(verifyType=='radio'?{"color":""}:{"border-color":""});
                    }).focus();
                    return '必填项不能为空';
                }
            },
            currencyId: function (value) {
            },
            tradeCurrencyId: function (value) {
            },
            areaId: function (value) {
            },
            position: function (value) {
            },
            area: function (value) {
            },
            searchName: function (value) {
            },
            status: function (value) {
            },
            tradeSwitch: function (value) {
            },
            priceSwitch: function (value) {
            },
            quantitySwitch: function (value) {
            },
            limitSwitch: function (value) {
            },
            buyRate: function (value) {
            },
            sellRate: function (value) {
            },
            minPirce: function (value) {
            },
            maxPirce: function (value) {
            },
            minQuantity: function (value) {
            },
            maxQuantity: function (value) {
            },
            limitRate: function (value) {
            },
            digitsP: function (value) {
            },
            digitsQ: function (value) {
            },
            virtualSwitch: function (value) {
            },
        });
        //监听提交
        form.on('submit(formSubmit)', function (data) {
            data=data.field;
            liuQi.ajax("/admin/currencyTrade/update",data,
                function (data) {
                    //关闭
                    parent.layer.msg(data.msg);
                    parent.layui.table.reload('currentTableId');
                    var index = parent.layer.getFrameIndex(window.name);
                    parent.layer.close(index);
                }
            );
            return false;
        });
    });
</script>

</body>
</html>